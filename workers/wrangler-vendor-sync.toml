name = "vendor-sync-worker"
main = "vendor-sync-worker.js"
compatibility_date = "2023-12-01"
account_id = "928f2a6b07f166d57bb4b31b9100d1f4"

[[d1_databases]]
binding = "DB"
database_name = "vehicle-dealership-analytics"
database_id = "d70754b6-fec7-483a-b103-c1c78916c497"

# Service binding to lambert-scraper worker
[[services]]
binding = "LAMBERT_SCRAPER"
service = "lambert-scraper"

# Service binding to NaniAuto scraper
[[services]]
binding = "NANIAUTO_SCRAPER"
service = "naniauto-scraper"

# Service binding to SLT Autos scraper
[[services]]
binding = "SLTAUTOS_SCRAPER"
service = "sltautos-scraper"

# Service binding to generic dealer scraper (fallback)
[[services]]
binding = "GENERIC_DEALER_SCRAPER"
service = "generic-dealer-scraper"

[vars]
ENVIRONMENT = "production"
CLOUDFLARE_ACCOUNT_ID = "928f2a6b07f166d57bb4b31b9100d1f4"

# Scheduled automatic syncing - Every 3 days at 2 AM UTC
# Rotates through vendors: Day 1 Lambert, Day 4 NaniAuto, Day 7 SLT, repeat
[triggers]
crons = ["0 2 */3 * *"]

# To set the Cloudflare Images API token, run:
# npx wrangler secret put CLOUDFLARE_IMAGES_TOKEN --config workers/wrangler-vendor-sync.toml
# Then paste your Cloudflare Images API token when prompted
